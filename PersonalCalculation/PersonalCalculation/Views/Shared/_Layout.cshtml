@using Microsoft.AspNet.Identity;

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>

    <script src="~/CSS_And_Script_File/jQuery/uncompressed/jquery-3.3.1.js"></script>
    <script src="~/CSS_And_Script_File/Ajax/jquery.unobtrusive-ajax.min.js"></script>
    <script src="~/CSS_And_Script_File/AngularJS/Angular.js"></script>
    <link href="~/CSS_And_Script_File/Animation/Animate.css" rel="stylesheet" />
    <script src="~/CSS_And_Script_File/Bootstrap/Bootstrap-3.3.7/js/bootstrap.js"></script>
    <link href="~/CSS_And_Script_File/Bootstrap/Bootstrap-3.3.7/css/bootstrap.css" rel="stylesheet" />
    <link href="~/CSS_And_Script_File/IHover/ihover.css" rel="stylesheet" />
    <script src="~/CSS_And_Script_File/SweetAlert/sweetalert.min.js"></script>

    <script src="~/RegistrationAndLoginPage/Logout.js"></script>

    @*change password sidebar*@
    <style>
        .sidenav {
            height: 450px; /*30%*/
            width: 0;
            position: fixed;
            z-index: 1;
            top: 80px;
            /*left: 0;*/
            right: 0;
            background-color: #EDEDED;
            overflow-x: hidden;
            transition: 0.5s;
            border-radius: 10px;
        }

            .sidenav .closebtn {
                position: absolute;
                top: 0;
                right: 25px;
                font-size: 36px;
                margin-left: 50px;
            }
    </style>
</head>
<body>          @*oncontextmenu="return false;"*@
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                @Html.ActionLink("Personal Calculation", "Index", "Home", new { area = "" }, new { @class = "navbar-brand" })
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li>@Html.ActionLink("Project", "Index", "Projects", new { area = "" }, null)</li>
                </ul>
                <div class="nav navbar-nav navbar-right">
                    <div class="btn-group" style="padding-top:12px;">
                        <a id="btnLogoff" class="btn btn-sm btn-default" style="width: 70px; height:27px; font-size: 12px">Logout</a>
                        <button type="button" style="height:27px" class="btn btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="caret"></span>
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <ul class="dropdown-menu">
                            <li><a href="#">Action</a></li>
                            <li><a href="#">Another action</a></li>
                            <li><a href="#">Settings</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="#" onclick="openNav()">Change Password</a></li>
                        </ul>
                    </div>
                </div>
                <ul class="nav navbar-nav navbar-right">
                    <li style="padding-right:20px"><a class="zoom-effect" href="#"><span class="glyphicon glyphicon-user" style="padding-right:10px"></span><b id="spanUserName" class="text-muted" style="color:white;"></b></a></li>
                    @*<li><a class="zoom-effect" href="#" id="btnLogoff"> Log Off </a></li>*@
                </ul>
            </div>
        </div>
    </div>
    <br /><br /><br />
    <div class="container body-content">
        @RenderBody()
        <br /> <br />
    </div>

    <footer id="footer">
        <div class="container">
            <div class="row">
                <hr style="color: black; border:0.5px solid">
                <p class="pull-right" style="font-size:17px">&copy; @DateTime.Now.Year - Developed by <a style="color: orange" target="_blank" href="https://www.facebook.com/profile.php?id=100004911679186">Redwan Hossain</a></p>
            </div>
        </div>
    </footer>

    <div id="mySidenav" class="sidenav shadow_B">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <div class="row">
            <div style="padding-left: 29px">
                <h3 style="color: orange">Change Password</h3>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="col-xs-12">
                <div class="col-xs-11">
                    <div class="form-group has-success">
                        <label>Current password</label>
                        <input id="Current_password" class="form-control" type="password" placeholder="Enter your current password" />
                    </div>
                </div>
                <div class="col-xs-11">
                    <div class="form-group has-success">
                        <label>New Password</label>
                        <input id="New_password" class="form-control" type="password" placeholder="Enter your new password" />
                    </div>
                </div>
                <div class="col-xs-11">
                    <div class="form-group has-success">
                        <label>Confirm new password</label>
                        <input id="Confirm_new_password" class="form-control" type="password" placeholder="Confirm new password" />
                    </div>
                </div>
                <br />
                <div class="col-xs-11">
                    <button id="btnChangePassword" style="margin-top:4px" class="btn btn-info btn-block">Change Password</button>
                </div>
                <div class="col-xs-11">
                    <br />
                    <!--Bootstrap alert to display any validation errors-->
                    <div id="divErrorPassword" class="alert alert-danger collapse">
                        <a id="linkClosePassword" href="#" class="close">&times;</a>
                        <div id="divErrorTextPassword"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

<script>
    function openNav() {
        document.getElementById("mySidenav").style.width = "300px";
    }

    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
    }
</script>

<script>
    $(document).ready(function () {
        //Close the bootstrap alert
        $('#linkClosePassword').click(function () {
            $('#divErrorPassword').hide('fade');
        });

        // Save the new user details
        $('#btnChangePassword').click(function () {
            $.ajax({
                url: '/api/Account/ChangePassword',
                method: 'POST',
                data: {
                    oldPassword: $('#Current_password').val(),
                    newPassword: $('#New_password').val(),
                    confirmPassword: $('#Confirm_new_password').val(),
                    userId: '@User.Identity.GetUserId()',
                },
                success: function () {
                    //alert('Password Change Successful!');
                    swal("Password Change Successful!", "Thank You. Now You Can Login With Your New Password.", "success");
                    // refresh the page...
                    //document.location.reload(true);
                    //swal("Password Change Successful!", "Thank You. Now You Can Login With Your New Password.", "success");
                    $('#divErrorPassword').hide();
                },
                error: function (jqXHR) {
                    $('#divErrorTextPassword').text(jqXHR.responseText);
                    $('#divErrorPassword').show('fade');
                }
            });

        });
    });
</script>
